<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IPv4 æŸ¥è¯¢ | GoToolOnline</title>
<meta name="description" content="åªæ˜¾ç¤º IPv4ï¼ˆç‚¹åˆ†åè¿›åˆ¶ï¼‰çš„å…¬ç½‘ IPï¼Œå¦é™„å®éªŒæ€§å†…ç½‘ IPï¼ˆ192.168/10/172.*ï¼‰æ¢æµ‹ã€‚"/>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><text x='6' y='52' font-size='48'>ğŸ› ï¸</text></svg>"/>
<style>
:root{--bg:#0a0f1e;--card:#0f1830;--muted:#9fb0c3;--fg:#eaf3ff;--acc:#4fb3ff}
*{box-sizing:border-box}
body{margin:0;font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,"PingFang SC","Microsoft YaHei",sans-serif;background:var(--bg);color:var(--fg)}
main,header,footer{max-width:880px;margin:0 auto;padding:0 18px}
header{display:flex;gap:12px;align-items:center;margin:22px auto 8px}
header .logo{display:flex;gap:10px;align-items:center;text-decoration:none;color:var(--fg);font-weight:800;font-size:22px}
.card{background:var(--card);border:1px solid #1a2843;border-radius:18px;padding:18px;margin:16px 0}
h1{margin:6px 0 8px;font-size:28px}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
button{padding:12px 14px;border-radius:12px;border:1px solid #24365b;background:linear-gradient(180deg,#2a78ff,#0050d4);color:#fff;font-weight:700;cursor:pointer}
button.secondary{background:#0f1a2f;color:#eaf3ff}
button:hover{filter:brightness(1.06)}
.result{margin-top:12px;padding:14px;background:#0c1426;border:1px dashed #2a3c64;border-radius:12px;font-size:20px;display:flex;justify-content:space-between;align-items:center;gap:10px}
.small{font-size:14px;color:var(--muted)}
.code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,"Cascadia Mono","Segoe UI Mono",Consolas,"Liberation Mono",monospace}
.copy{margin-left:auto;background:#0f1a2f;border:1px solid #24365b}
.tip{margin-top:8px}
footer{color:var(--muted);font-size:14px;margin:36px auto 28px}
@media (max-width:720px){ .result{flex-direction:column;align-items:flex-start} .copy{margin-left:0} }
</style>
</head>
<body>
<header>
  <a class="logo" href="./"><span>ğŸ› ï¸</span><strong>GoToolOnline</strong></a>
</header>
<main>
  <section class="card">
    <h1>IPv4 æŸ¥è¯¢ï¼ˆåªæ˜¾ç¤ºç‚¹åˆ†åè¿›åˆ¶ï¼‰</h1>
    <div class="row">
      <button id="btnV4">è·å–æˆ‘çš„ IPv4</button>
      <button id="btnCopy" class="copy">å¤åˆ¶</button>
      <button id="btnLan" class="secondary">å°è¯•è·å–å†…ç½‘ IPv4ï¼ˆå®éªŒï¼‰</button>
    </div>
    <div class="result">
      <span><span>ä½ çš„ IPv4ï¼š</span> <strong id="ip" class="code">â€”</strong></span>
      <span class="small" id="copied" style="display:none">å·²å¤åˆ¶ï¼</span>
    </div>
    <p class="small tip" id="note">è¯´æ˜ï¼šè¿™é‡Œæ˜¾ç¤ºçš„æ˜¯å…¬ç½‘ IPv4ï¼ˆç‚¹åˆ†åè¿›åˆ¶ï¼‰ã€‚å¦‚æœä½ çš„ç½‘ç»œæ²¡æœ‰åˆ†é…å…¬ç½‘ IPv4ï¼Œåªä¼šå¾—åˆ° IPv6 æˆ–å¤±è´¥ã€‚</p>
    <div class="card" style="margin-top:14px">
      <div class="small">å†…ç½‘ IPï¼ˆå¦‚ 192.168.x.x / 10.x.x.x / 172.16â€“31.x.xï¼‰å—æµè§ˆå™¨éšç§ä¿æŠ¤ï¼Œé€šå¸¸æ‹¿ä¸åˆ°ã€‚ä¸‹é¢æŒ‰é’®ç”¨ WebRTC è¯•æ¢ï¼ŒæˆåŠŸç‡ä¸ä¿è¯ã€‚</div>
      <div class="result" style="margin-top:10px">
        <span><span>å†…ç½‘ IPv4ï¼ˆå®éªŒï¼‰ï¼š</span> <strong id="lan" class="code">â€”</strong></span>
      </div>
    </div>
  </section>
</main>
<footer>Â© 2025 GoToolOnline.com</footer>

<script>
// ç®€å• IPv4 éªŒè¯
const IPV4_RE=/^(?:(?:25[0-5]|2[0-4]\\d|1?\\d?\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|1?\\d?\\d)$/;
const $=s=>document.querySelector(s);

function showCopied(){
  const el=$('#copied'); el.style.display=''; setTimeout(()=>el.style.display='none',1200);
}

function setText(id, txt){ const el=document.getElementById(id); if(el) el.textContent=txt; }

async function fetchIPv4(){
  setText('ip','æŸ¥è¯¢ä¸­â€¦');
  try{
    const ctrl=new AbortController();
    const t=setTimeout(()=>ctrl.abort(), 5000);
    const r=await fetch('https://api4.ipify.org?format=json', {signal:ctrl.signal, cache:'no-store'});
    clearTimeout(t);
    if(!r.ok) throw new Error('http '+r.status);
    const d=await r.json();
    const ip=String(d.ip||'');
    if(IPV4_RE.test(ip)){ setText('ip', ip); }
    else { setText('ip', 'æœªè·å–åˆ°å…¬ç½‘ IPv4'); }
  }catch(e){
    setText('ip','æœªè·å–åˆ°å…¬ç½‘ IPv4');
  }
}

function copyIPv4(){
  const v=($('#ip').textContent||'').trim();
  if(!IPV4_RE.test(v)) return;
  navigator.clipboard?.writeText(v).then(showCopied).catch(()=>{});
}

// â€”â€” å®éªŒï¼šå°è¯•è·å–å†…ç½‘ IPv4 â€”â€”
// è¯´æ˜ï¼šç°ä»£æµè§ˆå™¨å¯èƒ½åªè¿”å› mDNS hostï¼ˆxxxx.localï¼‰ï¼Œæˆ–å¹²è„†ä¸æš´éœ²ï¼›å› æ­¤æˆåŠŸç‡ä¸ä¿è¯ã€‚
async function detectLAN(){
  setText('lan','å°è¯•ä¸­â€¦');
  try{
    const pc=new RTCPeerConnection({iceServers:[]}); // æœ¬åœ°å€™é€‰å³å¯
    pc.createDataChannel('x');
    const found=new Set();
    const stop=()=>{ try{pc.close();}catch(e){} };
    const timer=setTimeout(()=>{ stop(); if($('#lan').textContent==='å°è¯•ä¸­â€¦') setText('lan','æœªè·å–åˆ°ï¼ˆæµè§ˆå™¨å·²å±è”½ï¼‰'); }, 7000);

    pc.onicecandidate=(e)=>{
      if(!e.candidate){ return; }
      const c=e.candidate.candidate||'';
      // ä»… host å€™é€‰
      if(!/ typ host\\b/.test(c)) return;
      // æŠ“ IPv4
      const m=c.match(/(\\d{1,3}(?:\\.\\d{1,3}){3})/);
      if(!m) return;
      const ip=m[1];
      if(!IPV4_RE.test(ip)) return;
      // åªæ”¶ RFC1918 ç§ç½‘
      if(/^10\\./.test(ip) || /^192\\.168\\./.test(ip) || /^172\\.(1[6-9]|2\\d|3[0-1])\\./.test(ip)){
        if(!found.has(ip)){
          found.add(ip);
          setText('lan', ip);
          clearTimeout(timer);
          stop();
        }
      }
    };
    const sdp=await pc.createOffer({offerToReceiveAudio:false,offerToReceiveVideo:false});
    await pc.setLocalDescription(sdp);
  }catch(e){
    setText('lan','æœªè·å–åˆ°ï¼ˆæµè§ˆå™¨å·²å±è”½ï¼‰');
  }
}

document.getElementById('btnV4').addEventListener('click', fetchIPv4);
document.getElementById('btnCopy').addEventListener('click', copyIPv4);
document.getElementById('btnLan').addEventListener('click', detectLAN);

// é¦–æ¬¡è‡ªåŠ¨æ‹‰å–å…¬ç½‘ IPv4
fetchIPv4();
</script>
</body>
</html>
